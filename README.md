用户抽奖的业务流程分为；给自己的活动账户添加额度（购买、兑换、打卡），领取活动（扣减互动账户额度）、执行抽奖策略、抽奖结果落库

领取活动->执行抽奖策略:

- 先把中奖消息写入task表
- 再异步发送mq消息通知奖品分发系统，无论发送成功或失败都会更新任务状态（成功是completed，失败是fail）。定时任务通过查询数据库中发送失败的task，进行重试。然后通过rabbitmq监听消息队列中的消息，并分发奖品。

- 事务隔离与原子性：通过spring的transactionTemplate确保数据库操作的原子性。

- 幂等性：通过数据库唯一索引和duplicateKeyException处理。

- 异步解耦：使用mq实现异步通信，将奖品记录和实际分发解耦。提高系统吞吐量；降低服务间依赖；支持灵活扩展

- 最终一致性：采用事务+消息补偿的机制：通过定时任务扫描未发送成功的消息进行补偿重试
失败处理机制：mq发送失败：记录状态，后续通过定时任务重试；发放奖品失败：在mq消费端实现重试或人工干预；数据库操作失败（DuplicateKeyException
e），通过事务回滚